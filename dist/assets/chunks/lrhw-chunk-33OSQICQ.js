import{a as le,b as ce,c as pe,d as me}from"./lrhw-chunk-645KYWXS.js";import{b as oe}from"./lrhw-chunk-VGORTJSX.js";import"./lrhw-chunk-7OANUOHB.js";import{a as ae,b as se,c as re,d as ne}from"./lrhw-chunk-DBLSEV5S.js";import{a as ie}from"./lrhw-chunk-J643D62O.js";import{h as C,j as T,k as b}from"./lrhw-chunk-GXYRYNUY.js";import{A as J,B as Q,C as I,D as X,E as Z,F as A,G as ee,H as O,N as te,e as d,g as c,h as $,j as L,o as k,p as S,q as P,r as F,t as v,w as W,x as K,y as H,z as q}from"./lrhw-chunk-KSXZ66RT.js";c();c();var z=d($());c();c();var U=(e,s,t)=>{let a=t?{"R-views":"#F8B4B5","R-downloads":"#FBC6CF","R-outlinks":"#FDD9E6","R-conversions":"#fff0aa","N-views":"#059FCC","N-downloads":"#05AFE0","N-outlinks":"#05C0F6","N-conversions":"#fff0aa","L-views":"#9E4F9D","L-downloads":"#A78FB4","L-outlinks":"#C4C8E2","L-conversions":"#fff0aa","ALL-views":"#CCCCCC","ALL-downloads":"#D6D6D6","ALL-outlinks":"#E0E0E0","ALL-conversions":"#fff0aa","L-L":"#8B92B3","R-R":"#D9BAB9","N-N":"#06B9ED"}:{"R-views":"#F1686A","R-downloads":"#F57B90","R-outlinks":"#F88DB6","R-conversions":"#fff0aa","N-views":"#059FCC","N-downloads":"#05AFE0","N-outlinks":"#05C0F6","N-conversions":"#fff0aa","L-views":"#7C3E7B","L-downloads":"#8F70A0","L-outlinks":"#ADB3D7","L-conversions":"#fff0aa","L-ALL":"#8B92B3","R-ALL":"#D9BAB9","N-ALL":"#13D7FC"},l=`${e}-${s}`;return a[l]||"#B8B8B8"};c();var G=(e,s)=>{let t=[];return typeof s=="string"?(e.time.buckets.map(n=>{var i,p,u;let o=n.level.buckets.find(g=>g.key===s),a=((i=o==null?void 0:o.views)==null?void 0:i.value)||0,l=((p=o==null?void 0:o.downloads)==null?void 0:p.value)||0,r=((u=o==null?void 0:o.outlinks)==null?void 0:u.value)||0;t.push(a+l+r)}),t):(e.time.buckets.map(n=>{var l;let o=n.level.buckets.find(r=>r.key===s.scope),a=((l=o==null?void 0:o[s.event])==null?void 0:l.value)||0;t.push(a)}),t)};var Y=d(L()),he=T,ke=C,De=({data:e,scopeLabels:s,eventLabels:t,activeScope:n,t:o,tabIndex:a})=>{let l=(0,z.useRef)(null);return(0,z.useEffect)(()=>{let r=ie(l.current);if(l.current){let i=[];n==="ALL"?ke.map(w=>{w!=="ALL"&&i.push({name:`${s[w]}`,type:"bar",stack:"total",itemStyle:{color:U(w,"ALL")},data:G(e,w)})}):he.map(h=>({scope:n,event:h})).forEach(h=>{i.push({name:`${s[h.scope]} - ${t[h.event]}`,type:`${h.event===b.C?"line":"bar"}`,yAxisIndex:`${h.event===b.C?1:0}`,stack:`${h.event===b.C?"":"total"}`,itemStyle:{color:U(h.scope,h.event)},data:G(e,h)})});let p=e.time.buckets.map(w=>new Date(w.key_as_string).toLocaleString(`${o("calendar-lang")}`,{month:"short",year:"numeric"})),u=Math.max(...i[0].data),g=Math.max(...i[1].data),M=Math.max(...i[2].data),B=u+g+M,_={tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{show:!1},grid:{left:"2%",top:"0%",right:"2%",bottom:"6%",containLabel:!1},yAxis:[{type:"value",max:B,name:"Total Access",nameTextStyle:{fontWeight:"bold",fontSize:13},show:!1},{type:"value",max:B,name:b.C,nameTextStyle:{fontWeight:"bold",fontSize:13},show:!1,alignTicks:!1,axisLine:{show:!0,lineStyle:{color:"#6e9ef1"}},axisLabel:{formatter:"{value}"}}],xAxis:{type:"category",data:p},series:i},j=()=>{r&&r.resize()};return window.addEventListener("resize",j),_&&r.setOption(_),()=>{window.removeEventListener("resize",j),r.dispose()}}},[n,a]),(0,Y.jsx)(S,{shadow:"sm",borderRadius:"12",p:"6",children:(0,Y.jsx)("div",{id:"bar-chart",ref:l,style:{height:"500px"}})})},fe=De;c();c();var de=d($());c();var V=(e,s)=>{var o,a,l;if(s==="ALL")return e.level.buckets.reduce((r,i)=>{var p,u,g;return r+(((p=i.views)==null?void 0:p.value)||0)+(((u=i.downloads)==null?void 0:u.value)||0)+(((g=i.outlinks)==null?void 0:g.value)||0)},0);let t=e.level.buckets.find(r=>r.key===s);return((((o=t==null?void 0:t.views)==null?void 0:o.value)||0)+(((a=t==null?void 0:t.downloads)==null?void 0:a.value)||0)+(((l=t==null?void 0:t.outlinks)==null?void 0:l.value)||0)).toLocaleString()},xe=(e,s,t,n)=>{let o=[];return e==="ALL"?o=[n("months"),...Object.keys(s).map(a=>s[a])]:o=[n("months"),...T.map(a=>t[a])],o},we=(e,s,t)=>{let n=[];return e==="ALL"?n=s.time.buckets.map(o=>[new Date(o.key_as_string).toLocaleString(`${t("calendar-lang")}`,{month:"short",year:"numeric"}),C.map(a=>V(o,a)).join(",")].join(",")):n=s.time.buckets.map(o=>[new Date(o.key_as_string).toLocaleString(`${t("calendar-lang")}`,{month:"short",year:"numeric"}),T.map(a=>{var l,r;return((r=(l=o.level.buckets.find(i=>i.key===e))==null?void 0:l[a])==null?void 0:r.value.toLocaleString())||0}).join(",")].join(",")),n},ue=(e,s,t,n,o)=>{let a=xe(e,n,o,t),l=we(e,s,t),r=[a.join(","),...l].join(`
`),i=new Blob([r],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(i),u=document.createElement("a");u.href=p,u.download=`${n[e]}-data.csv`,u.click(),URL.revokeObjectURL(p)};var m=d(L()),Le=({data:e,eventLabels:s,activeScope:t,scopeLabels:n,t:o})=>{let[a,l]=(0,de.useState)(0),r=i=>Object.keys(i).map((u,g)=>(0,m.jsxs)(O,{children:[" ",i[u]," "]},g));return(0,m.jsx)(S,{padding:"4",shadow:"sm",borderRadius:"12",mt:6,children:(0,m.jsxs)(X,{children:[(0,m.jsxs)(J,{variant:"striped",colorScheme:"gray",size:"lg",children:[(0,m.jsx)(Q,{children:(0,m.jsxs)(I,{children:[(0,m.jsx)(O,{children:o("months")}),r(t==="ALL"?n:s)]})}),(0,m.jsx)(Z,{children:e.time.buckets.map((i,p)=>(0,m.jsxs)(I,{children:[(0,m.jsx)(A,{children:new Date(i.key_as_string).toLocaleString(`${o("calendar-lang")}`,{month:"short",year:"numeric"})}),t==="ALL"?C.map((u,g)=>(0,m.jsx)(A,{children:V(i,u)},g)):T.map((u,g)=>{var M,B;return(0,m.jsx)(A,{children:((B=(M=i.level.buckets.find(_=>_.key===t))==null?void 0:M[u])==null?void 0:B.value.toLocaleString())||0},g)})]},p)).slice(10*a,10*(a+1))}),(0,m.jsx)(ee,{display:"flex",justifyContent:"start",py:"4",children:(0,m.jsx)(I,{children:(0,m.jsx)(A,{children:(0,m.jsx)(k,{onClick:()=>ue(t,e,o,n,s),colorScheme:"teal",children:o("csv-button")})})})})]}),(0,m.jsx)(v,{display:"flex",justifyContent:"space-evenly",children:(0,m.jsxs)(v,{display:"flex",gap:"2",children:[(0,m.jsx)(k,{variant:"ghost",onClick:()=>l(a-1),isDisabled:a===0,children:(0,m.jsx)(se,{fontSize:"1.5rem"})}),(0,m.jsx)(v,{display:"flex",gap:"2",alignItems:"center",children:Array.from({length:Math.ceil(e.time.buckets.length/10)},(i,p)=>(0,m.jsx)(k,{variant:a===p?"solid":"outline",onClick:()=>l(p),children:p+1},p))}),(0,m.jsx)(k,{variant:"ghost",onClick:()=>l(a+1),isDisabled:10*(a+1)>=e.time.buckets.length,children:(0,m.jsx)(re,{fontSize:"1.5rem"})})]})})]})})};c();var N=d($());var f=d(L()),ve=({data:e,eventLabels:s,activeScope:t,t:n})=>{let[o,a]=(0,N.useState)(e.level.buckets.filter(r=>r.key===t));(0,N.useEffect)(()=>{let r=[{key:"ALL",doc_count:0,views:{value:e.views.value},outlinks:{value:e.outlinks.value},downloads:{value:e.downloads.value},conversions:{value:e.conversions.value}}],i=e.level.buckets.filter(p=>p.key===t);a(t==="ALL"?r:i)},[t]);let l=[{title:b.V,label:s[b.V],value:e.views.value,icon:(0,f.jsx)(oe,{})},{title:b.D,label:s[b.D],value:e.downloads.value,icon:(0,f.jsx)(le,{})},{title:b.O,label:s[b.O],value:e.outlinks.value,icon:(0,f.jsx)(ce,{})},{title:b.C,label:s[b.C],value:e.conversions.value,icon:(0,f.jsx)(pe,{})}];return(0,f.jsx)(v,{children:o.map((r,i)=>(0,f.jsxs)(P,{gridTemplateColumns:{base:"repeat(1, minmax(0px, 1fr))",md:"repeat(2, minmax(0px, 1fr))",lg:"repeat(5, minmax(0px, 1fr))"},gap:"4",children:[(0,f.jsx)(S,{padding:"4",shadow:"sm",borderRadius:"12",children:(0,f.jsxs)(v,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,f.jsxs)(P,{children:[(0,f.jsxs)(v,{display:"flex",gap:"2",children:[(0,f.jsx)(F,{as:"span",fontWeight:"600",color:"gray",fontSize:"1.1rem",children:"Total"}),(0,f.jsx)(te,{label:n("tooltip-general-panel"),fontSize:"md",children:(0,f.jsx)(ae,{fontSize:"12px",color:"teal"})})]}),(0,f.jsx)(F,{as:"span",fontWeight:"700",fontSize:"1.3rem",children:(r.downloads.value+r.views.value+r.outlinks.value).toLocaleString()})]}),(0,f.jsx)(S,{p:"4",bg:"gray.100",variant:"elevated",shadow:"xs",borderRadius:"12",children:(0,f.jsx)(me,{})})]})}),l.map((p,u)=>(0,f.jsx)(S,{padding:"4",shadow:"sm",borderRadius:"12",children:(0,f.jsxs)(v,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,f.jsxs)(P,{children:[(0,f.jsx)(F,{as:"span",fontWeight:"600",color:"gray",fontSize:"1.1rem",children:p.label}),(0,f.jsx)(F,{as:"span",fontWeight:"700",fontSize:"1.3rem",children:r[p.title].value.toLocaleString()})]}),(0,f.jsx)(S,{p:"4",bg:"gray.100",variant:"elevated",shadow:"xs",borderRadius:"12",children:p.icon})]})},u))]},i))})};c();c();var R=d(L()),be=({t:e,setRefresh:s,setStartDate:t,refresh:n,startDate:o})=>{let a=[{label:`6 ${e("months")}`,callback:new Date(new Date().setFullYear(new Date().getMonth()-6))},{label:`1 ${e("year")}`,callback:new Date(new Date().setFullYear(new Date().getFullYear()-1))},{label:`3 ${e("years")}`,callback:new Date(new Date().setFullYear(new Date().getFullYear()-3))}],l=r=>{t(r),console.log(r),s(!n)};return(0,R.jsx)(v,{borderRadius:"12",children:(0,R.jsx)(v,{display:"flex",gap:"2",children:a.map(({label:r,callback:i})=>(0,R.jsx)(S,{shadow:"sm",borderRadius:"12",p:"1",justifyContent:"center",rounded:"lg",children:(0,R.jsx)(k,{onClick:()=>l(i),size:"sm",fontWeight:"bold",variant:o===i?"solid":"outline",children:r})},r))})})};c();c();var x=d(L()),Se=({scopeLabels:e,activeScope:s,setActiveScope:t})=>(0,x.jsx)(S,{shadow:"sm",mr:"4",borderRadius:"6",p:"1",children:(0,x.jsxs)(W,{children:[(0,x.jsx)(q,{as:k,variant:"outline",rightIcon:(0,x.jsx)(ne,{}),children:e[s]}),(0,x.jsx)(H,{children:e&&Object.keys(e).map(n=>(0,x.jsx)(K,{color:"gray.600",fontWeight:"medium",onClick:()=>t(n),children:e[n]},n))})]})});var E=d(L()),ye=({t:e,scopeLabels:s,activeScope:t,setActiveScope:n,setStartDate:o,setRefresh:a,refresh:l,startDate:r})=>(0,E.jsx)(v,{my:"6",children:(0,E.jsxs)(v,{display:"flex",justifyContent:"space-between",children:[(0,E.jsx)(v,{display:"flex",alignItems:"center",children:(0,E.jsx)(Se,{scopeLabels:s,activeScope:t,setActiveScope:n})}),(0,E.jsx)(be,{t:e,setRefresh:a,setStartDate:o,refresh:l,startDate:r})]})});c();var ge=d(L());var D=d(L()),Ce=({data:e,scopeLabels:s,eventLabels:t,activeScope:n,setActiveScope:o,t:a,tabIndex:l,setStartDate:r,setRefresh:i,refresh:p,startDate:u})=>(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(ve,{data:e,scopeLabels:s,eventLabels:t,activeScope:n,t:a}),(0,D.jsx)(ye,{t:a,scopeLabels:s,activeScope:n,setActiveScope:o,setStartDate:r,setRefresh:i,refresh:p,startDate:u}),(0,D.jsx)(fe,{data:e,scopeLabels:s,eventLabels:t,activeScope:n,setActiveScope:o,t:a,tabIndex:l}),(0,D.jsx)(Le,{data:e,eventLabels:t,scopeLabels:s,activeScope:n,t:a})]}),Pt=Ce;export{Pt as default};
